// public/src/utils/agentResponseFormatter.js

/**
 * Formats agent responses to match the simple search format
 * @param {string} question - The original question
 * @param {Array} agentResponses - The responses from different agents
 * @param {Array} selectedAgents - The list of agent IDs that were selected
 * @returns {string} Formatted HTML
 */
export const formatAgentResponses = (
  question,
  agentResponses,
  selectedAgents = []
) => {
  // If no responses, return an error message
  if (!agentResponses || Object.keys(agentResponses).length === 0) {
    return `
      <div class="simple-search-results error">
        <h3>No Agent Responses</h3>
        <p>No responses were received from the selected agents.</p>
      </div>
    `;
  }

  // Start building the HTML
  let html = `
    <div class="simple-search-results">
      <h3>Agent Responses</h3>
      <p><strong>Query:</strong> "${question}"</p>
      
      <div class="simple-search-content">
  `;

  // Add each agent's response
  for (const agentId in agentResponses) {
    const agentName = getAgentName(agentId);
    const response = agentResponses[agentId];

    html += `
      <div class="agent-result">
        <h4>${agentName}</h4>
        <div class="agent-answer">
          ${response}
        </div>
      </div>
    `;
  }

  // Add key points section if multiple agents responded
  if (Object.keys(agentResponses).length > 1) {
    html += `
      <div class="search-key-points">
        <h4>Key Points</h4>
        <ul>
          <li>Multiple agents have provided responses to your query</li>
          <li>Each agent specializes in different areas of expertise</li>
          <li>Consider all perspectives when evaluating the information</li>
        </ul>
      </div>
    `;
  }

  // Add related questions/follow-up section
  html += `
      <div class="search-related-section">
        <h4>Follow-up Questions</h4>
        <div class="gemini-chips-container">
          <div class="gemini-chips">
            <button class="gemini-chip" onclick="document.querySelector('.input-field').value='Tell me more about ${question}'; setTimeout(() => document.querySelector('.send-btn').click(), 100);">
              <span class="gemini-chip-icon">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z" 
                    fill="currentColor"
                  />
                </svg>
              </span>
              <span class="gemini-chip-text">Tell me more about this</span>
            </button>
            <button class="gemini-chip" onclick="document.querySelector('.input-field').value='How does this compare to other options?'; setTimeout(() => document.querySelector('.send-btn').click(), 100);">
              <span class="gemini-chip-icon">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z" 
                    fill="currentColor"
                  />
                </svg>
              </span>
              <span class="gemini-chip-text">How does this compare to other options?</span>
            </button>
          </div>
        </div>
      </div>
  `;

  // Close the main content div
  html += `
      </div>
      
      <div class="simple-search-note">
        <p><small>This response was generated by AI agents based on your query. Results may vary in accuracy and completeness.</small></p>
      </div>
    </div>
  `;

  return html;
};

/**
 * Helper function to get readable agent names from IDs
 * @param {string} agentId - The agent ID
 * @returns {string} The readable agent name
 */
export const getAgentName = (agentId) => {
  const agentNames = {
    MRlQT_lhFw: "Client Agent",
    zr_ag: "ZR Agent",
    jira_ag: "Jira Agent",
    conf_ag: "Confluence Agent",
    zp_ag: "ZP Agent",
  };

  return agentNames[agentId] || agentId;
};
